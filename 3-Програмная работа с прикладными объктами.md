# Oglavlenie
1. [Программная работа с перечисленями, константами и справочниками.](#1)
	+ [ООП ПОЯ](#1-1)
    + [Методы глобального контекста](#1-2)
    + [Программная работа с константами](#1-3)
    + [Программная работа с перечислениями](#1-4)
    + [Программная работа со справочниками](#1-5)
    + [Табличная часть](#1-6)






# 1
# Программная работа с перечисленями, константами и справочниками.

# 1-1
# ООП ПОЯ
[Оглавление](#Oglavlenie)
![ООП ПОЯ](/images/ООП/ООП.png)

![ООП ПОЯ](/images/ООП/Объектная%20модель%201.png)
![ООП ПОЯ](/images/ООП/Объктная%20модель%202.png)

![ООП ПОЯ](/images/ООП/Свойства%20и%20методы.png)

![ООП ПОЯ](/images/ООП/Объктная%20модель%201С.png)

![ООП ПОЯ](/images/ООП/ПОЯ.png)

# 1-2 
# Методы глобального контекста
[Оглавление](#Oglavlenie)

+ Запись журнала регистрации
```
ЗаписьЖурналаРегистрации("ТестоваяЗапись", УровеньЖурналаРегистрации.Информация);
```
+ Запустить приложение
```
ПутьКФайлу = "E:\1_IRONSKILLS\1_Курсы\0_Программист 1С - с нуля до профи (2023)\Домашки\P16 - Начисления.xlsx";
ЗапуститьПриложениеАсинх(ПутьКФайлу);
```
+ Получить имя временного файла
```
ИмяФайла = ПолучитьИмяВременногоФайла("xlsx");
Сообщение = Новый СообщениеПользователю;
Сообщение.Текст = ИмяФайла;
Сообщение.Сообщить();
```
+ Открыть форму
```
ОткрытьФорму("Документ.ЗаказКлиента.ФормаСписка");
```
+ Открыть справкуи
```
ОткрытьСправку();
```
+ Обновить интерфейс
```
ОбновитьИнтерфейс();
```
+ Имя компьютера
```
Сообщение = Новый СообщениеПользователю;
Сообщение.Текст = ИмяКомпьютера();
Сообщение.Сообщить();
```

# 1-3
# Программная работа с константами
[Оглавление](#Oglavlenie)

![Програмная работа с константами](/images/ООП/Програмная%20работа%20с%20константами.png)


+ Получить значение константы
```
Валюта = Константы.ВалютаУчета.Получить();

Сообщение = Новый СообщениеПользователю;
Сообщение.Текст = Валюта;
Сообщение.Сообщить();
```

+ Установить значение константы
```
Константы.ЗаголовокСистемы.Установить("Управление компанией, ред. 2.0");

НовоеЗначение = Константы.ЗаголовокСистемы.Получить();
Сообщение = Новый СообщениеПользователю;
Сообщение.Текст = НовоеЗначение;
Сообщение.Сообщить();
```
+ Набор констант
```
НаборКонстант = Константы.СоздатьНабор("ВалютаУчета, ЗаголовокСистемы");
НаборКонстант.Прочитать();

Текст = СтрШаблон("Валюта учета: %1; Заголовок: %2",
					 НаборКонстант.ВалютаУчета, НаборКонстант.ЗаголовокСистемы);
					 
Сообщение = Новый СообщениеПользователю;
Сообщение.Текст = Текст;
Сообщение.Сообщить();
```

+ Обход всех констант
```
Для каждого МенеджерКонстанты ИЗ Константы Цикл

	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = МенеджерКонстанты.Получить();
	Сообщение.Сообщить();
	
КонецЦикла;
```

# 1-4
# Программная работа с перечислениями
[Оглавление](#Oglavlenie)

 ![Програмная работа с перечислениями](/images/ООП/Програмная%20работа%20с%20перечислениями.png)

 
 + Получить значение перечисления
 ```
День = Перечисления.ДниНедели.Воскресенье;
Сообщение = Новый СообщениеПользователю;
Сообщение.Текст = День;
Сообщение.Сообщить();

// Установить значение константы
Константы.СпособДоставкиПоУмолчанию.Установить(Перечисления.СпособыДоставки.Самовывоз);

ТекущийСпособДоставки = Константы.СпособДоставкиПоУмолчанию.Получить();
Если ТекущийСпособДоставки = Перечисления.СпособыДоставки.Почта Тогда
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Способ доставки - Почта";
	Сообщение.Сообщить();
Иначе
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Текущий способ доставки: " + ТекущийСпособДоставки;
	Сообщение.Сообщить();
КонецЕсли;
 ```

 + Значение перечисления на клиенте
 ```
 //СпособДоставки = Перечисления.СпособыДоставки.Почта;
СпособДоставки = ПредопределенноеЗначение("Перечисление.СпособыДоставки.Почта");

 ```
+ Пустая ссылка на перечисление 
```
ПустаяСсылка = Перечисления.ТипыСкладов.ПустаяСсылка();
```

+ Обход значений перечисления в цикле

```
Для каждого Значение Из Перечисления.ДниНедели Цикл
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = Значение;
	Сообщение.Сообщить();
КонецЦикла;

День = Перечисления.ДниНедели["Воскресенье"];
```

# 1-5 
# Программная работа со справочниками
[Оглавление](#Oglavlenie)

+ ![Программная работа со справочниками](/images/ООП/Програмная%20работа%20со%20справочниками.png)

![Программная работа со справочниками](/images/ООП/СправочникСслыка%20и%20Справочник%20Объект.png)

+ Создать элемент
```
НовыйТовар = Справочники.Номенклатура.СоздатьЭлемент();
НовыйТовар.Наименование = "Мышь компьютерная";
НовыйТовар.Артикул = "А-1";
НовыйТовар.ТипНоменклатуры = Перечисления.ТипыНоменклатуры.Товар;
НовыйТовар.СпособПополнения = Перечисления.СпособыПополненияТоваров.Закупка;
НовыйТовар.Записать();
```

+ Создать группу
```
//НоваяГруппа = Справочники.Номенклатура.СоздатьГруппу();
//НоваяГруппа.Наименование = "Умные часы";
//НоваяГруппа.Записать();

НоваяГруппа = Справочники.ВидыЦен.СоздатьГруппу();
НоваяГруппа.Наименование = "Оптовые";
НоваяГруппа.Записать();
```
+ Найти элемент
```
// поиск по коду
Товар = Справочники.Номенклатура.НайтиПоКоду("00000000018");
Если Товар.Пустая() Тогда
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Товар не найден";
	Сообщение.Сообщить();
Иначе
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Артикул товара: " + Товар.Артикул;
	Сообщение.Сообщить();
КонецЕсли;

// поиск по наименованию
Товар = Справочники.Номенклатура.НайтиПоНаименованию("Телевизор Sony Bravia X90K XR-65X90K", Истина);
Если Товар.Пустая() Тогда
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Товар не найден";
	Сообщение.Сообщить();
Иначе
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Артикул товара: " + Товар.Артикул;
	Сообщение.Сообщить();
КонецЕсли;

// поиск по реквизиту
Товар = Справочники.Номенклатура.НайтиПоРеквизиту("НаименованиеПолное", "Телевизор Xiaomi TV Q2 55"" (международная версия)");  
Если Товар.Пустая() Тогда
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Товар не найден";
	Сообщение.Сообщить();
Иначе
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Артикул товара: " + Товар.Артикул;
	Сообщение.Сообщить();
КонецЕсли;
```
+ Найти элемент (внутри группы)
```
Группа = Справочники.Номенклатура.НайтиПоНаименованию("Планшеты");

Если НЕ Группа.Пустая() Тогда
	
	Товар = Справочники.Номенклатура.НайтиПоНаименованию("Планшет HONOR Pad 8 128GB",,Группа);
	
	Если Товар.Пустая() Тогда
		Текст = "Товар не найден";
	Иначе
		Текст = "Артикул товара: " + Товар.Артикул
	КонецЕсли;
	
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = Текст;
	Сообщение.Сообщить();
	
Иначе
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Группа не найдена";
	Сообщение.Сообщить();
КонецЕсли;

```
+ Найти элемент (в пределах подчинения)
```
Контрагент = Справочники.Контрагенты.НайтиПоНаименованию("МИКО");
Если НЕ Контрагент.Пустая() Тогда

	Договор = Справочники.ДоговорыКонтрагентов.НайтиПоРеквизиту("НомерДоговора", "15",,Контрагент);
	Если НЕ Договор.Пустая() Тогда
		Текст = СтрШаблон("Дата договора: %1; Владелец: %2", Договор.ДатаДоговора, Договор.Владелец);
	Иначе
		Текст = "Договор не найден";
	КонецЕсли;
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = Текст;
	Сообщение.Сообщить();
	
Иначе
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Контрагент не найден в справочнике";
	Сообщение.Сообщить();
КонецЕсли;
```
+ Создать элемент внутри группы
```
Группа = Справочники.Номенклатура.НайтиПоКоду("00000000034");

Если НЕ Группа.Пустая() Тогда

	НовыйТовар = Справочники.Номенклатура.СоздатьЭлемент();
	НовыйТовар.Наименование = "Мышь компьютерная";
	НовыйТовар.Родитель = Группа;
	НовыйТовар.Артикул = "А-1";
	НовыйТовар.ТипНоменклатуры = Перечисления.ТипыНоменклатуры.Товар;
	НовыйТовар.СпособПополнения = Перечисления.СпособыПополненияТоваров.Закупка;
	НовыйТовар.Записать();
	
Иначе
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Группа не найдена";
	Сообщение.Сообщить();	
КонецЕсли;
```
+ Изменить элемент
```
// 1. Найти ссылку
Товар = Справочники.Номенклатура.НайтиПоКоду("00000000035");
Если НЕ Товар.Пустая() Тогда

	// 2. По ссылке получить объект (если ссылка не пустая)
	ТоварОбъект = Товар.ПолучитьОбъект();
	
	// 3. Изменить свойства объекта
	ТоварОбъект.ЕдиницаИзмерения = Справочники.КлассификаторЕдиницИзмерения.шт;
	
	// 4. Записать объект
	ТоварОбъект.Записать();
	
Иначе
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Товар не найден";
	Сообщение.Сообщить();
КонецЕсли;
```
+ Пометить элемент на удаление
```
Товар = Справочники.Номенклатура.НайтиПоКоду("00000000035");

Если НЕ Товар.Пустая() Тогда
	ТоварОбъект = Товар.ПолучитьОбъект();
	ТоварОбъект.УстановитьПометкуУдаления(Истина);		
	Текст = "Товар успешно помечен на удаление";
Иначе
	Текст = "Товар не найден";
КонецЕсли;

Сообщение = Новый СообщениеПользователю;
Сообщение.Текст = Текст;
Сообщение.Сообщить();
```
+ Пометить группу на удаление
```
// пример пометки на удаление группы
Группа = Справочники.Номенклатура.НайтиПоКоду("00000000034");

Если НЕ Группа.Пустая() Тогда
	ГруппаОбъект = Группа.ПолучитьОбъект();
	ГруппаОбъект.УстановитьПометкуУдаления(Истина);		
	Текст = "Группа успешно помечена на удаление";
Иначе
	Текст = "Группа не найден";
КонецЕсли;

Сообщение = Новый СообщениеПользователю;
Сообщение.Текст = Текст;
Сообщение.Сообщить();
```
+ Пустая ссылка на справочник
```
ПустаяСсылка = Справочники.Номенклатура.ПустаяСсылка();
```
+ Выборка элементов справочника
```
Выборка = Справочники.Номенклатура.Выбрать();

Пока Выборка.Следующий() Цикл
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = Выборка.Наименование;
	Сообщение.Сообщить();
КонецЦикла;

```
+ Выбрать все планшеты
```
Группа = Справочники.Номенклатура.НайтиПоКоду("00000000015");
Если НЕ Группа.Пустая() Тогда 
	Выборка = Справочники.Номенклатура.Выбрать(Группа);
	Пока Выборка.Следующий() Цикл
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = Выборка.Наименование;
		Сообщение.Сообщить();
	КонецЦикла;
Иначе
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Группа не найдена";
	Сообщение.Сообщить();
КонецЕсли;
```
+ Выбрать все договоры контрагента
```
Контрагент = Справочники.Контрагенты.НайтиПоНаименованию("МИКО");
Если НЕ Контрагент.Пустая() Тогда
	
	Выборка = Справочники.ДоговорыКонтрагентов.Выбрать(, Контрагент);
	Пока Выборка.Следующий() Цикл
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = Выборка.Наименование;
		Сообщение.Сообщить();
	КонецЦикла;
	
Иначе
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Контрагент не найден";
	Сообщение.Сообщить();
КонецЕсли;
		
```
+ Выбрать все товары
```
Отбор = Новый Структура;
Отбор.Вставить("ТипНоменклатуры", Перечисления.ТипыНоменклатуры.Товар);
Выборка = Справочники.Номенклатура.Выбрать(,,Отбор);
Пока Выборка.Следующий() Цикл
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = Выборка.Наименование;
	Сообщение.Сообщить();
КонецЦикла;
```
+ Перенести несколько товаров в группу
```

НоваяГруппа = Справочники.Номенклатура.НайтиПоКоду("00000000034");

Если НЕ НоваяГруппа.Пустая() Тогда

	ПустаяГруппа = Справочники.Номенклатура.ПустаяСсылка();
	Отбор = Новый Структура;
	Отбор.Вставить("ТипНоменклатуры", Перечисления.ТипыНоменклатуры.Товар);
	
	Выборка = Справочники.Номенклатура.Выбрать(ПустаяГруппа,,Отбор);
	Пока Выборка.Следующий() Цикл
		ТоварОбъект = Выборка.ПолучитьОбъект();
		ТоварОбъект.Родитель = НоваяГруппа;
		ТоварОбъект.Записать();
	КонецЦикла;
	Текст = "Товары перемещены в группу";
Иначе
	Текст = "Группа не найдена";
КонецЕсли;

Сообщение = Новый СообщениеПользователю;
Сообщение.Текст = Текст;
Сообщение.Сообщить();
```

# 1-6
# Табличная часть
[Оглавление](#Oglavlenie)

+ Добавить строку
```
// поиск элемента справочника с табличной частью
Контрагент = Справочники.Контрагенты.НайтиПоКоду("000000002");
Если НЕ Контрагент.Пустая() Тогда

	// получение объекта по ссылке
	КонтрагентОбъект = Контрагент.ПолучитьОбъект();

	// добавление строки в табличную часть
	СтрокаТаблицы = КонтрагентОбъект.КонтактнаяИнформация.Добавить();
	
	// заполнение реквизитов табличной части
	СтрокаТаблицы.Тип = Перечисления.ТипыКонтактнойИнформации.Телефон;
	СтрокаТаблицы.Вид = Справочники.ВидыКонтактнойИнформации.ТелефонКонтрагента;
	СтрокаТаблицы.Представление = "+7 (495) 456-87-94";
	
	// запись объекта
	КонтрагентОбъект.Записать();
	
Иначе
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Контрагент не найден";
	Сообщение.Сообщить();	
КонецЕсли;

```
+ Найти одну строку
```
// поиск элемента справочника с табличной частью
Контрагент = Справочники.Контрагенты.НайтиПоКоду("000000002");
Если НЕ Контрагент.Пустая() Тогда

	// получение объекта по ссылке
	КонтрагентОбъект = Контрагент.ПолучитьОбъект();

	ВидКИ = Справочники.ВидыКонтактнойИнформации.ТелефонКонтрагента;
	
	СтрокаТаблицы = КонтрагентОбъект.КонтактнаяИнформация.Найти(ВидКИ, "Вид");
	
	Если СтрокаТаблицы = Неопределено Тогда
	
		// добавление строки в табличную часть
		СтрокаТаблицы = КонтрагентОбъект.КонтактнаяИнформация.Добавить();
	
		// заполнение реквизитов табличной части
		СтрокаТаблицы.Тип = Перечисления.ТипыКонтактнойИнформации.Телефон;
		СтрокаТаблицы.Вид = Справочники.ВидыКонтактнойИнформации.ТелефонКонтрагента;
		
	КонецЕсли;
	
	СтрокаТаблицы.Представление = "+7 (495) 784-87-94";
	
	// запись объекта
	КонтрагентОбъект.Записать();
	
Иначе
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Контрагент не найден";
	Сообщение.Сообщить();	
КонецЕсли;
```
+ Найти несколько строк
```
Контрагент = Справочники.Контрагенты.НайтиПоКоду("000000001");
Если НЕ Контрагент.Пустая() Тогда
		
	ПараметрыОтбора = Новый Структура;
	ПараметрыОтбора.Вставить("Тип", Перечисления.ТипыКонтактнойИнформации.Адрес);
	
	МассивСтрок = Контрагент.КонтактнаяИнформация.НайтиСтроки(ПараметрыОтбора);
	Для каждого СтрокаТаблицы Из МассивСтрок Цикл
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = Строка(СтрокаТаблицы.Вид) + ": " + СтрокаТаблицы.Представление;
		Сообщение.Сообщить();
	КонецЦикла;

	Иначе
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Контрагент не найден";
	Сообщение.Сообщить();
КонецЕсли;
```
+ Получить количество строк
```
Контрагент = Справочники.Контрагенты.НайтиПоКоду("000000001");
Если НЕ Контрагент.Пустая() Тогда
		
	ПараметрыОтбора = Новый Структура;
	ПараметрыОтбора.Вставить("Тип", Перечисления.ТипыКонтактнойИнформации.Адрес);
	
	Количество = Контрагент.КонтактнаяИнформация.Количество();
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Кол-во контактов: " + Количество;
	Сообщение.Сообщить();

Иначе
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Контрагент не найден";
	Сообщение.Сообщить();
КонецЕсли;
```
+ Обойти строки в цикле
```
Контрагент = Справочники.Контрагенты.НайтиПоКоду("000000001");
Если НЕ Контрагент.Пустая() Тогда
	
	Для каждого СтрокаТаблицы ИЗ Контрагент.КонтактнаяИнформация Цикл
		
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = Строка(СтрокаТаблицы.Вид) + ":" + СтрокаТаблицы.Представление;
		Сообщение.Сообщить();
	КонецЦикла;
	
Иначе
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Контрагент не найден";
	Сообщение.Сообщить();
КонецЕсли;
```
+ Выгрузить в таблицу значений
```
Контрагент = Справочники.Контрагенты.НайтиПоКоду("000000001");
Если НЕ Контрагент.Пустая() Тогда
	
	ТаблицаКонтактов = Контрагент.КонтактнаяИнформация.Выгрузить();
	
	Для каждого СтрокаТаблицы ИЗ ТаблицаКонтактов Цикл
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = Строка(СтрокаТаблицы.Вид) + ":" + СтрокаТаблицы.Представление;
		Сообщение.Сообщить();
	КонецЦикла;
	
Иначе
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Контрагент не найден";
	Сообщение.Сообщить();
КонецЕсли;
```
+ Сортировать
```
СсылкаНаДокумент = Документы.ЗаказКлиента.НайтиПоНомеру("000000004", ТекущаяДата());

Если НЕ СсылкаНаДокумент.Пустая() Тогда
	
	ДокументОбъект = СсылкаНаДокумент.ПолучитьОбъект();
	ДокументОбъект.Товары.Сортировать("СуммаВсего Убыв");
	ДокументОбъект.Записать();
	
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Таблица отсортирована";
	Сообщение.Сообщить();
	
Иначе

	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Документ не найден";
	Сообщение.Сообщить();
	
КонецЕсли;
```
+ Получить итог по колонке
```
СсылкаНаДокумент = Документы.ЗаказКлиента.НайтиПоНомеру("000000004", ТекущаяДата());

Если НЕ СсылкаНаДокумент.Пустая() Тогда
	
	ДокументОбъект = СсылкаНаДокумент.ПолучитьОбъект();
	
	СуммаДокумента = ДокументОбъект.Товары.Итог("СуммаВсего");
		
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Сумма заказа: " + СуммаДокумента;
	Сообщение.Сообщить();
	
Иначе

	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Документ не найден";
	Сообщение.Сообщить();
	
КонецЕсли;
```